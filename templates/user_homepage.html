{% extends 'base.html' %}

{% block title %}ðŸŒˆ{{ user.fname }}'s Homepage!{% endblock %}

{% block body %}
  <h1>ðŸ“š Welcome, {{ user.fname }}! ðŸ“š </h1>
  <img src="{{ user.profile_pic }}">

  <p><a href="/pie">Check out this pie!</a></p>
  <p><a href="/timeline">Look at your timeline!</a></p>

  <!-- from bootstrap sortable table -->
  <link href="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.css" rel="stylesheet">
  <script src="https://unpkg.com/bootstrap-table@1.18.3/dist/bootstrap-table.min.js"></script>
  
  <h3>Your Updates</h3>
  <table
    data-toggle="table"
    data-search="true"
    data-show-columns="true">
    <thead>
      <tr>
        <th>Update ID</th>
        <th>Title</th>
        <th>Date</th>
        <th>Value</th>
        <th>Update Date</th>
        <th>Started?</th>
        <th>Finished?</th>
        <th>DNF?</th>
      </tr>
    </thead>
    <tbody>
      {% for update in user.updates %} 
        <tr id="tr-id-{{ update.update_id }}" class="tr-class-{{ update.update_id }}" 
        data-title="bootstrap table" data-object='{"key": "value"}'>
          <td>{{ update.update_id }}</td>
          <td>{{ update.item.title }}</td>
          <td>{{ update.date }}</td>
          <td>{{ update.update_value }}</td>
          <td>{{ update.update_entered_at }}</td>
          <td>{{ update.start_bool }}</td>
          <td>{{ update.end_bool }}</td>
          <td>{{ update.dnf }}</td>
        </tr>
        <!-- {{ update.item.title }} {{ update.update_entered_at }} {{ update.date }} -->
      {% endfor %} 
    </tbody>
  </table>

  <div id="collection-details"></div>

  <div id="collections-display">
    <h3>Your collections:</h3>
    {% for collection in user.collections %} 
      <div id="collection-display-{{ collection.collection_id }}">
        <h5 class="collection" id="{{ collection.collection_id }}" 
          value="{{ collection.collection_id }}">
          {{ collection.name }}
          {% if not collection.public %} 
            (private)
          {% endif %} 
        </h5>
        {% for user_item in collection.user_media %}
          <img src="{{ user_item.item.cover }}" class="{{ user_item.user_media_id }}">
        {% endfor %}
      </div>
    {% endfor %} 
  </div>
  <div>
    <button class="collection-actions" id="create-collection">Add New Collection</button>
    <div id="new-collection"></div>
    <div id="which-collection-to-add-to"></div>
  </div>

  <div id="item-details"></div>

  <div>
    <h3>Your media:</h3>
    <div><a href="/search">Search for new items</a></div>
    <div>
      {% for user_item in user.media %} 
        <img src="{{ user_item.item.cover }}" class="user-media-id {{ user_item.user_media_id }}" 
        id="{{ user_item.user_media_id }}" value="{{ user_item.user_media_id }}">
      {% endfor %}
    </div>
  </div>

  <script src="/static/js/manage.js"></script>
  
{% endblock %}